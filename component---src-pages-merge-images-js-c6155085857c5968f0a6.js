(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"9/5/":function(t,e,i){(function(e){var i=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,r=/^0o[0-7]+$/i,l=parseInt,o="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,d=o||c||Function("return this")(),h=Object.prototype.toString,u=Math.max,g=Math.min,s=function(){return d.Date.now()};function f(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function p(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==h.call(t)}(t))return NaN;if(f(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=f(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var o=a.test(t);return o||r.test(t)?l(t.slice(2),o?2:8):n.test(t)?NaN:+t}t.exports=function(t,e,i){var n,a,r,l,o,c,d=0,h=!1,m=!1,b=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function j(e){var i=n,r=a;return n=a=void 0,d=e,l=t.apply(r,i)}function w(t){return d=t,o=setTimeout(y,e),h?j(t):l}function x(t){var i=t-c;return void 0===c||i>=e||i<0||m&&t-d>=r}function y(){var t=s();if(x(t))return v(t);o=setTimeout(y,function(t){var i=e-(t-c);return m?g(i,r-(t-d)):i}(t))}function v(t){return o=void 0,b&&n?j(t):(n=a=void 0,l)}function O(){var t=s(),i=x(t);if(n=arguments,a=this,c=t,i){if(void 0===o)return w(c);if(m)return o=setTimeout(y,e),j(c)}return void 0===o&&(o=setTimeout(y,e)),l}return e=p(e)||0,f(i)&&(h=!!i.leading,r=(m="maxWait"in i)?u(p(i.maxWait)||0,e):r,b="trailing"in i?!!i.trailing:b),O.cancel=function(){void 0!==o&&clearTimeout(o),d=0,n=c=a=o=void 0},O.flush=function(){return void 0===o?l:v(s())},O}}).call(this,i("yLpj"))},mhLB:function(t,e,i){"use strict";i.r(e);var n=i("kD0k"),a=i.n(n),r=(i("ls82"),i("/S4K")),l=i("t8Zj"),o=i("q1tI"),c=i("XuZe"),d=i("qKvR"),h=i("TJpk"),u=i.n(h),g=i("ctKR"),s=i("tBpk"),f=i.n(s),p=i("9/5/"),m=i.n(p);function b(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var w={name:"8f7gql",styles:"font-size:1.6rem;text-align:center;margin:1rem 0;@media (min-width:500px){font-size:2rem;margin:2rem 0 1rem 0;}"},x={name:"1wwzxmg",styles:"margin:30px 0;display:grid;grid-template-columns:repeat(auto-fit,50px);grid-gap:15px;div{display:flex;width:50px;height:50px;}.image-thumbnail{object-fit:cover;width:50px;height:50px;box-shadow:0 0 3px grey;}.delete-icon{width:20px;height:20px;transform:translate(-10px,-10px);}"},y={name:"16kh2z9",styles:"display:grid;grid-template-columns:1fr 1fr;margin:20px 0;place-items:center;"},v={name:"mt6m9k",styles:"#input-file{position:absolute;visibility:hidden;width:0px;height:0px;}"},O={name:"lpos2x",styles:"font-size:20px;font-weight:bold;box-sizing:border-box;border:1px solid grey;padding:4px 8px;background-color:lightcyan;box-shadow:0 0 3px grey;text-decoration:none;color:black;display:block;text-align:center;:active{color:red;text-decoration:none;}"},M={name:"wix0nd",styles:"display:block;margin:50px auto;box-shadow:0 0 3px grey;"},N={name:"ic9k1p",styles:".form-radio{display:grid;grid-template-columns:repeat(auto-fill,minmax(100px,1fr));p{font-size:18px;font-weight:bold;margin-bottom:10px;grid-column:1 / -1;}label{font-size:16px;}label input{margin-right:5px;font-size:16px;}}.form-text-input{p{font-size:18px;font-weight:bold;margin-bottom:10px;}input{padding:2px 4px;font-size:16px;width:100%;max-width:300px;}}.form-color{p{font-size:18px;font-weight:bold;margin-bottom:10px;}input{margin-right:10px;}}.form-slider{p{font-size:18px;font-weight:bold;margin-bottom:10px;}label{vertical-align:middle;}input{font-size:16px;width:80%;max-width:300px;margin-right:10px;}}"},z=function(){var t=Object(r.a)(a.a.mark((function t(e){var i,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(t){return new Promise((function(e,i){var n=document.createElement("canvas"),a=n.getContext("2d");n.width=100,n.height=100;var r=Math.min(t.height,t.width),l=Math.min(t.height,t.width),o=new Image;o.src=t.url,o.onload=function(){a.fillStyle="white",a.fillRect(0,0,100,100),a.drawImage(o,0,0,r,l,0,0,100,100);var t=n.toDataURL("image/jpeg");e(t),i("get thumbnail 出错")}}))},n=e.map((function(t){return i(t)})),t.next=5,Promise.all(n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(t){var e;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(t))return 3===(e=t.substring(1).split("")).length&&(e=[e[0],e[0],e[1],e[1],e[2],e[2]]),"rgba("+[(e="0x"+e.join(""))>>16&255,e>>8&255,255&e].join(",")+",1)";throw new Error("Bad Hex")};e.default=function(){var t=Object(o.useState)([]),e=t[0],i=t[1],n=Object(o.useState)([]),h=n[0],s=n[1],p=Object(o.useState)({direction:"vertical",widthSetting:"equalWidth",alignVertical:"alignCenterVertical",heightSetting:"equalHeight",alignHorizontal:"alignCenterHorizontal",watermark:"",watermarkColor:"#e66465",margin:10,opacity:.3,fontSize:50}),j=p[0],I=p[1],k=Object(o.useState)(j.margin),S=k[0],C=k[1],E=Object(o.useState)(j.opacity),q=E[0],W=E[1],H=Object(o.useState)(j.fontSize),L=H[0],A=H[1],D="";Object(o.useEffect)((function(){Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.next=3,z(e);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))()}),[e]),Object(o.useEffect)((function(){!function(t,e){var i=window.devicePixelRatio,n=e.direction,o=e.widthSetting,c=e.alignVertical,d=e.heightSetting,h=e.alignHorizontal,u=e.watermark,g=e.watermarkColor,s=e.margin,f=e.opacity,p=e.fontSize,m=document.getElementById("canvas"),j=m.getContext("2d"),w=Math.max.apply(Math,Object(l.a)(t.map((function(t){return t.width})))),x=Math.max.apply(Math,Object(l.a)(t.map((function(t){return t.height})))),y=t.map((function(t){var e=t.width,i=t.height,n=t.height,a=t.width;return"equalWidth"===o&&(e=w,i=t.height/t.width*e),"equalHeight"===d&&(n=x,a=t.width/t.height*n),{url:t.url,width:t.width,height:t.height,widthEqual:e,heightWhenWidthEqual:Math.round(i),heightEqual:n,widthWhenHeightEqual:Math.round(a)}}));console.log("imagesNew:",y);var v=y.reduce((function(t,e){return t+e.widthWhenHeightEqual}),0),O=v+s*(y.length-1),M=y.reduce((function(t,e){return t+e.heightWhenWidthEqual}),0),N=M+s*(y.length-1);console.log("totalWidth:",v,"totalHeight:",M,"largestWidth:",w,"largestHeight:",x),"vertical"===n?(m.width=w,m.height=N,m.style.width=Math.round(w/i)+"px",m.style.maxWidth="80%",m.style.height=m.height/m.width*m.style.width+"px"):(m.width=O,m.height=x,m.style.width=Math.round(m.width/i)+"px",m.style.maxWidth="100%",m.style.height=m.height/m.width*m.style.width+"px"),console.log("canvas.style.width:",m.style.width,"canvas.style.height:",m.style.height),j.fillStyle="white",j.fillRect(0,0,m.width,m.height);for(var z,I=function(t,e,i,n,l,o,c,d,h){var s=new Image;s.src=t.url,s.onload=Object(r.a)(a.a.mark((function t(){var r,b,w,x;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log(111,s,e,i,n,l,o,c,d,h),j.drawImage(s,e,i,n,l,o,c,d,h),j.save(),j.fillStyle=T(g).replace(/,1\)/g,","+f+")"),j.textAlign="center",j.textBaseline="middle",j.font=p+"px serif",j.translate(Math.round(m.width/2),Math.round(m.height/2)),j.rotate(45*Math.PI/180),r=Math.sqrt(m.width/2*m.width/2+m.height/2*m.height/2),b=j.measureText(u).width,w=0;w<r;w=w+1*b+2*p)for(x=0;x<r;x+=3*p)0===w&&0===x?j.fillText(u,w,x,r):0===w&&0!==x?(j.fillText(u,w,x,r),j.fillText(u,w,-x,r)):0!==w&&0===x?(j.fillText(u,w,x,r),j.fillText(u,-w,x,r)):(j.fillText(u,w,x,r),j.fillText(u,-w,x,r),j.fillText(u,w,-x,r),j.fillText(u,-w,-x,r));j.restore();case 13:case"end":return t.stop()}}),t)})))},k=b(y.entries());!(z=k()).done;){var S=z.value,C=S[0],E=S[1];if("vertical"===n){if("equalWidth"===o){I(E,0,0,E.width,E.height,0,y.slice(0,C).reduce((function(t,e){return t+e.heightWhenWidthEqual}),0)+s*C,E.widthEqual,E.heightWhenWidthEqual)}else if("alignLeft"===c){I(E,0,0,E.width,E.height,0,y.slice(0,C).reduce((function(t,e){return t+e.height}),0)+s*C,E.widthEqual,E.heightWhenWidthEqual)}else if("alignCenterVertical"===c){I(E,0,0,E.width,E.height,Math.round((w-E.width)/2),y.slice(0,C).reduce((function(t,e){return t+e.height}),0)+s*C,E.widthEqual,E.heightWhenWidthEqual)}else if("alignRight"===c){I(E,0,0,E.width,E.height,w-E.width,y.slice(0,C).reduce((function(t,e){return t+e.height}),0)+s*C,E.widthEqual,E.heightWhenWidthEqual)}}else if("equalHeight"===d){I(E,0,0,E.width,E.height,y.slice(0,C).reduce((function(t,e){return t+e.widthWhenHeightEqual}),0)+s*C,0,E.widthWhenHeightEqual,E.heightEqual)}else if("alignTop"===h){I(E,0,0,E.width,E.height,y.slice(0,C).reduce((function(t,e){return t+e.width}),0)+s*C,0,E.widthWhenHeightEqual,E.heightEqual)}else if("alignCenterHorizontal"===h){var q=E.width,W=E.height,H=Math.round((x-E.height)/2);I(E,0,0,q,W,y.slice(0,C).reduce((function(t,e){return t+e.width}),0)+s*C,H,E.width,E.height)}else if("alignBottom"===h){var L=E.width,A=E.height,D=x-E.height;I(E,0,0,L,A,y.slice(0,C).reduce((function(t,e){return t+e.width}),0)+s*C,D,E.widthWhenHeightEqual,E.heightEqual)}}}(e,j)}),[e,j]);var B=function(){var t=Object(r.a)(a.a.mark((function t(e){var n,r,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(l.a)(e.target.files).map((function(t){return URL.createObjectURL(t)})),console.log("files:",n),r=function(t){return new Promise((function(e,i){var n=new Image;n.src=t,n.onload=function(){e({width:+n.width,height:+n.height,url:n.src}),i("出错")}}))},t.next=5,Promise.all(n.map((function(t){return r(t)})));case 5:o=t.sent,i(o);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=function(t){var n=t.target.dataset.index,a=JSON.parse(JSON.stringify(e));a.splice(n,1),i(a)},J=function(t){D=t.target},Q=function(t){var n=t.target;if(n.style.border="none",n.src!==D.src){var a=JSON.parse(JSON.stringify(e)),r=a.map((function(t){return t.url})).indexOf(n.src),l=a.map((function(t){return t.url})).indexOf(D.src),o=a[r];a[r]=a[l],a[l]=o,i(a)}},V=function(t){t.preventDefault()},U=function(t){t.target.style.border="1px solid red"},Y=function(t){t.target.style.border="none"},P=Object(o.useCallback)(m()((function(t,e){var i=JSON.parse(JSON.stringify(j));i[e]=t,I(i)}),250),[j]),G=function(t){var e=t.target.value,i=t.target.name;switch(i){case"margin":C(e);break;case"fontSize":A(e);break;case"opacity":W(e)}C(S),P(e,i)};return Object(d.d)(c.a,null,Object(d.d)(u.a,null,Object(d.d)("title",null,"图片拼接 | 长图拼接"),Object(d.d)("meta",{name:"description",content:"图片拼接, 把多张图片合并成一张, 支持纵向或横向拼接, 可以把多张图片拼接成一张长图片, 还能添加水印."})),Object(d.d)("h1",{css:w},"图片拼接 | 长图拼接"),Object(d.d)("section",null,Object(d.d)("form",{onChange:function(t){var e=t.target.name,i=t.target.value;if(!["margin","fontSize","opacity"].includes(e)){var n=JSON.parse(JSON.stringify(j));n[e]=i,I(n)}},css:N},Object(d.d)("div",{className:"form-radio"},Object(d.d)("p",null,"拼接方向"),Object(d.d)("label",{for:"vertical"},Object(d.d)("input",{type:"radio",id:"vertical",name:"direction",value:"vertical",checked:"vertical"===j.direction}),"纵向拼接"),Object(d.d)("label",{for:"horizontal"},Object(d.d)("input",{type:"radio",id:"horizontal",name:"direction",value:"horizontal",checked:"horizontal"===j.direction}),"横向拼接")),"vertical"===j.direction?Object(d.d)("div",{className:"form-radio"},Object(d.d)("p",null,"宽度设置"),Object(d.d)("label",{for:"equalWidth"},Object(d.d)("input",{type:"radio",id:"equalWidth",name:"widthSetting",value:"equalWidth",checked:"equalWidth"===j.widthSetting}),"等宽"),Object(d.d)("label",{for:"originalWidth"},Object(d.d)("input",{type:"radio",id:"originalWidth",name:"widthSetting",value:"originalWidth",checked:"originalWidth"===j.widthSetting}),"原始宽度")):Object(d.d)("div",{className:"form-radio"},Object(d.d)("p",null,"高度设置"),Object(d.d)("label",{for:"equalHeight"},Object(d.d)("input",{type:"radio",id:"equalHeight",name:"heightSetting",value:"equalHeight",checked:"equalHeight"===j.heightSetting}),"等高"),Object(d.d)("label",{for:"originalHeight"},Object(d.d)("input",{type:"radio",id:"originalHeight",name:"heightSetting",value:"originalHeight",checked:"originalHeight"===j.heightSetting}),"原始高度")),"vertical"===j.direction?Object(d.d)("div",{className:"form-radio"},Object(d.d)("p",null,"对齐方式"),Object(d.d)("label",{for:"alignLeft"},Object(d.d)("input",{type:"radio",id:"alignLeft",name:"alignVertical",value:"alignLeft",checked:"alignLeft"===j.alignVertical,disabled:"equalWidth"===j.widthSetting}),"左对齐"),Object(d.d)("label",{for:"alignCenterVertical"},Object(d.d)("input",{type:"radio",id:"alignCenterVertical",name:"alignVertical",value:"alignCenterVertical",checked:"alignCenterVertical"===j.alignVertical,disabled:"equalWidth"===j.widthSetting}),"左右居中"),Object(d.d)("label",{for:"alignRight"},Object(d.d)("input",{type:"radio",id:"alignRight",name:"alignVertical",value:"alignRight",checked:"alignRight"===j.alignVertical,disabled:"equalWidth"===j.widthSetting}),"右对齐")):"horizontal"===j.direction?Object(d.d)("div",{className:"form-radio"},Object(d.d)("p",null,"对齐方式"),Object(d.d)("label",{for:"alignTop"},Object(d.d)("input",{type:"radio",id:"alignTop",name:"alignHorizontal",value:"alignTop",checked:"alignTop"===j.alignHorizontal,disabled:"equalHeight"===j.heightSetting}),"上对齐"),Object(d.d)("label",{for:"alignCenterHorizontal"},Object(d.d)("input",{type:"radio",id:"alignCenterHorizontal",name:"alignHorizontal",value:"alignCenterHorizontal",checked:"alignCenterHorizontal"===j.alignHorizontal,disabled:"equalHeight"===j.heightSetting}),"上下居中"),Object(d.d)("label",{for:"alignBottom"},Object(d.d)("input",{type:"radio",id:"alignBottom",name:"alignHorizontal",value:"alignBottom",checked:"alignBottom"===j.alignHorizontal,disabled:"equalHeight"===j.heightSetting}),"下对齐")):"",Object(d.d)("div",{className:"form-text-input"},Object(d.d)("p",null,"自定义水印"),Object(d.d)("input",{type:"text",id:"watermark",name:"watermark",placeholder:"请输入要显示的水印...",value:j.water})),Object(d.d)("div",{className:"form-color"},Object(d.d)("p",null,"水印颜色"),Object(d.d)("label",{for:"watermarkColor"},Object(d.d)("input",{type:"color",id:"watermarkColor",name:"watermarkColor",value:j.watermarkColor}),j.watermarkColor)),Object(d.d)("div",{className:"form-slider"},Object(d.d)("p",null,"水印透明度"),Object(d.d)("label",{for:"opacity"},Object(d.d)("input",{type:"range",id:"opacity",name:"opacity",min:"0",max:"1",step:"0.1",value:q,onChange:G}),q)),Object(d.d)("div",{className:"form-slider"},Object(d.d)("p",null,"水印大小"),Object(d.d)("label",{for:"fontSize"},Object(d.d)("input",{type:"range",id:"fontSize",name:"fontSize",min:"1",max:"500",value:L,onChange:G}),L,"px")),Object(d.d)("div",{className:"form-slider"},Object(d.d)("p",null,"图片间距"),Object(d.d)("label",{for:"margin"},Object(d.d)("input",{type:"range",id:"margin",name:"margin",min:"0",max:"500",value:S,onChange:G}),S,"px")))),Object(d.d)("section",null,Object(d.d)("div",{css:y},Object(d.d)("div",{css:v},Object(d.d)("label",{htmlFor:"input-file",css:O},"选择图片"),Object(d.d)("input",{id:"input-file",type:"file",onChange:B,multiple:!0,accept:"image/*"})),Object(d.d)("a",{download:!0,onClick:function(){var t=document.getElementById("canvas"),e=document.getElementById("download");if(0===t.width)e.removeAttribute("href");else{var i=t.toDataURL("image/jpeg");e.href=i}},id:"download",href:"https://kejiweixun.com/merge-images/",css:O,role:"button"},"保存图片")),Object(d.d)("div",{css:x},h.map((function(t,e){return Object(d.d)("div",{key:t,draggable:"true",onDragStart:J,onDrop:Q,onDragOver:V,onDragEnter:U,onDragLeave:Y},Object(d.d)("img",{src:t,className:"image-thumbnail",alt:"thumbnail"}),Object(d.d)("img",{src:f.a,className:"delete-icon",onClick:R,"data-index":e,alt:"delete icon"}))}))),Object(d.d)("canvas",{id:"canvas",css:M,width:"0px",height:"0px"})),Object(d.d)(g.a,{title:"图片拼接",slug:"merge-images/"}))}},tBpk:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB0PSIxNTk2NzkzNTg0MzU0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQ2OTQiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNNTEyIDBDMjI5LjM3NiAwIDAgMjI5LjM3NiAwIDUxMnMyMjkuMzc2IDUxMiA1MTIgNTEyIDUxMi0yMjkuMzc2IDUxMi01MTJTNzk0LjYyNCAwIDUxMiAweiBtMjAyLjI0IDY4My41MmMxMC4yNCAxMC4yNCAxMC4yNCAyNi4xMTIgMCAzNi4zNTJzLTI2LjExMiAxMC4yNC0zNi4zNTIgMGwtMTY3LjkzNi0xNjcuOTM2LTE2Ny40MjQgMTY3LjQyNGMtMTAuMjQgMTAuMjQtMjYuMTEyIDEwLjI0LTM2LjM1MiAwcy0xMC4yNC0yNi4xMTIgMC0zNi4zNTJsMTY3LjQyNC0xNjcuNDI0LTE2OC45Ni0xNjkuOTg0Yy0xMC4yNC0xMC4yNC0xMC4yNC0yNi4xMTIgMC0zNi4zNTJzMjYuMTEyLTEwLjI0IDM2LjM1MiAwbDE2OS40NzIgMTY5LjQ3MiAxNjkuOTg0LTE2OS45ODRjMTAuMjQtMTAuMjQgMjYuMTEyLTEwLjI0IDM2LjM1MiAwczEwLjI0IDI2LjExMiAwIDM2LjM1MmwtMTY5Ljk4NCAxNjkuOTg0IDE2Ny40MjQgMTY4LjQ0OHoiIGZpbGw9IiNDRDI5MkEiIHAtaWQ9IjQ2OTUiPjwvcGF0aD48L3N2Zz4="}}]);
//# sourceMappingURL=component---src-pages-merge-images-js-c6155085857c5968f0a6.js.map