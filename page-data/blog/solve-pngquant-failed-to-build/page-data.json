{"componentChunkName":"component---src-template-blog-post-template-js","path":"/blog/solve-pngquant-failed-to-build/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>我的网站 kejiweixun.com 是用 gatsbyjs 所写, 今天通过 <code class=\"language-text\">npm update</code> 升级 node packages 时, 终端提示以下错误:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token operator\">></span> pngquant-bin@5.0.2 postinstall /Users/to/Documents/kejiweixun.com/node_modules/pngquant-bin\n<span class=\"token operator\">></span> node lib/install.js\n\n  ⚠ <span class=\"token builtin class-name\">read</span> ECONNRESET\n  ⚠ pngquant pre-build <span class=\"token builtin class-name\">test</span> failed\n  ℹ compiling from <span class=\"token builtin class-name\">source</span>\n  ✖ Error: pngquant failed to build, <span class=\"token function\">make</span> sure that libpng is installed\n    at /Users/to/Documents/kejiweixun.com/node_modules/bin-build/node_modules/execa/index.js:231:11\n    at processTicksAndRejections <span class=\"token punctuation\">(</span>internal/process/task_queues.js:97:5<span class=\"token punctuation\">)</span>\n    at async Promise.all <span class=\"token punctuation\">(</span>index <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>如果没记错这个问题我遇到不止一次, 但上一次应该是好几个月之前, 不记得当时怎么解决, 今天再遇到, 又花了大概半小时才找到解决办法, 而且很多人遇到了一样的问题, 所以在这里记录一下以防忘记, 当然这个方法不一定适用于每个人.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; color: grey; margin: 0; padding: 0\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHt1Ggxh//EABYQAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAQABBQIRCL//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAVEAEBAAAAAAAAAAAAAAAAAAAQAf/aAAgBAQAGPwJj/8QAGRAAAgMBAAAAAAAAAAAAAAAAAAEQIVGh/9oACAEBAAE/IXbR6XhZyCj/2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAAQARECGhseH/2gAIAQEAAT8QGlIBNwT7g02VOO6y/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/715c4f3d6e761164c36b1a7796295d2a/ba381/pngquant_error.webp 200w,\n/static/715c4f3d6e761164c36b1a7796295d2a/7f61c/pngquant_error.webp 400w,\n/static/715c4f3d6e761164c36b1a7796295d2a/d00b9/pngquant_error.webp 800w,\n/static/715c4f3d6e761164c36b1a7796295d2a/a5d4d/pngquant_error.webp 1000w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/715c4f3d6e761164c36b1a7796295d2a/e07e9/pngquant_error.jpg 200w,\n/static/715c4f3d6e761164c36b1a7796295d2a/066f9/pngquant_error.jpg 400w,\n/static/715c4f3d6e761164c36b1a7796295d2a/4b190/pngquant_error.jpg 800w,\n/static/715c4f3d6e761164c36b1a7796295d2a/a2510/pngquant_error.jpg 1000w\"\n          sizes=\"(max-width: 800px) 100vw, 800px\"\n          type=\"image/jpeg\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/715c4f3d6e761164c36b1a7796295d2a/4b190/pngquant_error.jpg\"\n          alt=\"pngquant error\"\n          title=\"pngquant error\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n    </span></p>\n<p>解决办法就是:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">brew <span class=\"token function\">install</span> pkg-config</code></pre></div>\n<p>参考 github 的 issue <a href=\"https://github.com/gatsbyjs/gatsby/issues/20389#issuecomment-650105336\">底部的评论</a>.</p>\n<p>在执行 <code class=\"language-text\">brew install pkg-config</code> 时我又遇到以下错误:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token operator\">==</span><span class=\"token operator\">></span> <span class=\"token variable\"><span class=\"token variable\">`</span>brew cleanup<span class=\"token variable\">`</span></span> has not been run <span class=\"token keyword\">in</span> <span class=\"token number\">30</span> days, running now<span class=\"token punctuation\">..</span>.\nError: Permission denied @ apply2files - /usr/local/lib/node_modules/gatsby-cli/node_modules/term-size/vendor/macos/.DS_Store</code></pre></div>\n<p>解决方法是:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> -R <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">whoami</span><span class=\"token variable\">)</span></span>\"</span>:admin /usr/local/lib</code></pre></div>\n<p>参考资料: <a href=\"https://stackoverflow.com/a/63241724\">出处</a></p>","frontmatter":{"title":"解决 pngquant failed to build, make sure that libpng is installed 的方法","date":"2020/08/18","slug":"solve-pngquant-failed-to-build","description":null}}}]}},"pageContext":{"slug":"solve-pngquant-failed-to-build"}},"staticQueryHashes":["1518281631"]}